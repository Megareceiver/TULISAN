<!DOCTYPE html>
<html>
	<head>
		<!-- Standard Meta -->
		<meta charset="utf-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
		<link rel="icon" type="image/x-icon" href="../assets/PICS/TL_Favicon.png">
		<!-- Site Properities -->
		<title>Tulisan</title>
	  
		<link href="../assets/css/bootstrap.min.css" rel="stylesheet">
		<link href="../assets/css/font-awesome.min.css" rel="stylesheet">
		<link href="../assets/css/syncard-inject.css" rel="stylesheet">
	</head>
	<body>

		<div class="container">
			<header class="parent"></header>

			<main class="parent clear">
				<div id="cart-list" class="col-md-8 col-md-offset-2 div-normalize">
					<h1>SHOPING CART</h1>
				</div>
				<div id="cart-summary" class="col-md-8 col-md-offset-2 div-normalize">
					<div class="table-box">
						<ul class="cart-cell clear">
							<li class="col-md-3"><b>Grand total <span id="itemsTotal"></span></b></li>
							<li class="col-md-9 text-right"><span id="total"></span></li>
						</ul>
						<ul class="cart-cell clear">
							<li class="col-md-7 hidden-sm hidden-xs"></li>
							<li class="col-md-5">
								<button type="button" class="btn btn-warning form-control">Check out</button>
							</li>
						</ul>
					</div>
				</div>
			</main>	
	
			<footer class="parent"></footer>
		</div>

		<!-- Script collection -->
		<script type="text/javascript" src="../assets/js/jquery-3.2.1.min.js"></script>
		<script type="text/javascript" src="../assets/js/jquery-ui-1.10.0.custom.min.js"></script>
		<script type="text/javascript" src="../assets/js/bootstrap.min.js"></script>	
		<script type="text/javascript" src="../assets/js/imagesloaded.pkgd.min.js"></script>
		<script type="text/javascript" src="../assets/js/partial.js"></script>	

		<!-- page script -->
		<script type="text/javascript">
			var temp = 0;
			var itemCounter = 0;
			loadData();

			function loadData(){
				var html = '';
				var data = [
					{ 'productId': 'LDA02014', 'productName': 'Beach Bag', 'productPicture': 'db_file_img_539_350x350.jpg', 'price': '86000', 'quantity': '1' },
					{ 'productId': 'LDA02012', 'productName': 'Daisy Loops', 'productPicture': 'db_file_img_740_350x350.jpg', 'price': '20000', 'quantity': '1' },
				];

				var total = 0;

				html = html + '<div class="table-box">';
				for(var loop=0; loop<data.length; loop++){
					html = html + 
					'<ul class="cart-cell" id="' + data[loop].productId + '">' +
						'<li class="col-md-2"><img class="big-image" src="../assets/PICS/' + data[loop].productPicture + '"/></li>' +
						'<li class="col-md-5">' + 
							'<h4>' + data[loop].productName + '</h4>' + 
							'<button type="button" class="btn btn-danger" delete-list="' + data[loop].productId + '">Delete</button>' +
						'</li>' +
						'<li class="col-md-3">' + currencyFormat(data[loop].price) + '</li>' +
						'<li class="col-md-2 col-sm-4 col-xs-4"><input type="number" class="form-control price" d-price="' + data[loop].price + '" value="' + data[loop].quantity + '" /></li>' +
					'</ul>';
					html = html + '<div class="clearfix"></div>';

					total = total + parseInt(data[loop].price);
				}

				html = html + '</div>';

				if(data.length == 0) html = "<div class='col-md-12 text-danger'>No items added yet</div>" + html;

				$("main #cart-list").append(html);

				//===================================================================================
				var itemsTotal = '(' + data.length + ((data.length > 1) ? " items" : ' item' ) + ')';
				$("#itemsTotal").html(itemsTotal);
				$("#total").html(currencyFormat(String(total)));
				temp = total;
				itemCounter = data.length;


				/* price calculator */
				$('.price').on('click', function(){
					$("#total").html('Please wait..');
				});

				$('.price').on('change', function(){
					priceSummary();
				});

				$('.price').on('blur', function(){
					$("#total").html(currencyFormat(String(temp)));
					$("#totalTemp").val(temp);
				});

				/* delete function*/
				$('[delete-list]').on('click', function(){
					target = $(this).attr('delete-list');
					$("#" + target).remove();
					priceSummary();
					itemCounter = itemCounter -1;
					itemsTotal = '(' + itemCounter + ((itemCounter > 1) ? " items" : ' item' ) + ')';
					$("#itemsTotal").html(itemsTotal);

					if(itemCounter == 0) $("main #cart-list").append("<div class='col-md-12 text-danger'>No items added yet</div>");
				});

			}

			function priceSummary(){
				tempRest = 0;
				$('.price').each(function(){
					tempRest = tempRest + parseInt($(this).val()) * $(this).attr('d-price');
				});
				setTimeout(function(){
					$("#total").html(currencyFormat(String(tempRest)));
					$("#totalTemp").val(tempRest);
					temp = tempRest;
				}, 500);
			}
		</script>
	</body>
</html>